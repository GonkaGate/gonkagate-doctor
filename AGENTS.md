# Repository Guidelines

## Project Overview

This repository tracks the **GonkaGate CLI** (`gonkagate`) with an MVP command: `gonkagate doctor`. The goal is to provide fast, deterministic diagnostics for connecting to the GonkaGate OpenAI-compatible API (base URL validity, model availability, pricing reachability). The behavioral spec and UX examples live in `docs/prd.md` and should be treated as the source of truth; use `docs/gonkagate-project-overview.md` for product context (not normative for CLI behavior).

## Required Tools

- Node.js 20+ (CI uses Node 20; local can be newer).
- npm (bundled with Node.js).
- Git.

Optional:

- `nvm` for switching Node versions (recommended if you work on multiple Node projects).

## Project Structure & Module Organization

- `docs/prd.md`: product requirements, checks, JSON output format, and exit codes.
- `docs/gonkagate-project-overview.md`: product context/background narrative (not normative for CLI behavior).
- `README.md`: project entrypoint (expand as implementation ships).
- `src/`: TypeScript implementation.
- `src/cli.ts`: CLI entrypoint (commander).
- `src/commands/doctor.ts`: `doctor` command implementation.
- `src/lib/`: shared utilities (URL/config/http/output).
- `tests/`: Vitest test suite (`tests/**/*.test.ts`).
- `dist/`: build output (generated by `npm run build`).

Suggested module layout as it grows: `src/lib/config.ts`, `src/lib/http.ts`, `src/lib/output.ts`.

## Build, Test, and Development Commands

Install dependencies:

- `npm install`

Standard scripts (see `package.json`):

- `npm run dev -- doctor ...` run from source for iteration.
- `npm run build` compile to `dist/`.
- `npm start -- doctor ...` run the built CLI.
- `npm run typecheck` run the TypeScript typecheck.
- `npm test` run the test suite.
- `npm run lint` run the linter.
- `npm run format` format with Prettier.
- `npm run ci` run the full local CI suite.

Common examples:

- `npm run dev -- doctor --model <id>`
- `npm run dev -- doctor --model <id> --json`

Distribution sanity check (from the PRD): `npx gonkagate@latest doctor --model <id>`.

## Coding Style & Naming Conventions

- TypeScript (Node.js 20+). Keep checks small and composable; avoid hidden side effects.
- 2-space indentation; format with Prettier.
- Naming: `camelCase` for values/functions, `PascalCase` for types, `kebab-case` for multi-word filenames.
- Never print secrets (mask API keys in logs and `--json` output).

## Testing Guidelines

- Unit tests: URL normalization, timeout and exit-code mapping, and JSON output shape.
- Integration tests: HTTP behavior using a local stub server.
- Naming: `tests/**/*.test.ts`.

## Commit & Pull Request Guidelines

- Git history currently uses short imperative subjects (example: "Initial commit"); prefer Conventional Commits going forward (`feat:`, `fix:`, `docs:`).
- PRs should include: a clear description, reference to the relevant `docs/prd.md` section, and sample `doctor` output (human and/or `--json`) for behavior changes.

## Security & Configuration Tips

- The CLI base URL is fixed to `https://api.gonkagate.com/v1`.
- Prefer env vars for local config: `GONKAGATE_API_KEY`, `GONKAGATE_MODEL`.
- Do not commit local secrets. `.env` is already ignored in `.gitignore`.
